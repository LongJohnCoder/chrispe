<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><link type="text/css" rel="stylesheet" href="chrispe.css" media="screen" /><title>ChrisPE</title></head><body><font> 
 
 
 
<p> 
<select ONCHANGE="location = this.options[this.selectedIndex].value;"> 
<option value="" disabled></option> 
<option value="../readme.html">Contents</option> 
<option value="" disabled>=======</option> 
<option value="winpe.htm">Windows PE</option>  
<option value="builder.htm">Builders</option>  
<option value="options.htm">Project Options</option>  
<option value="project.htm" selected="selected">Project Scripts</option>  
<option value="instructions_pebakery.htm">Instructions</option>  
<option value="menu_system.htm">Menu System</option>  
<option value="not_in_wim.htm">Include...in boot.wim</option>  
<option value="usb.htm">...Bootable USB...</option>  
<option value="uefi.htm">UEFI, BIOS, GPT...</option>  
<option value="multiboot.htm">Multiboot WinPE</option>  
<option value="" disabled></option> 
<option value="" disabled>Appendices</option> 
<option value="" disabled>=========</option> 
<option value="quick_pebakery.htm">Quick Start</option>  
<option value="acknowledgements.htm">Acknowledgements</option>  
<option value="" disabled></option> 
</select> 
</p> 
 
 
 
<hr> 
<a href="http://chrispe.mistyprojects.co.uk/"><img src="img/home.jpg" BORDER=1></a> 
 




<h2><u>Project Scripts</u></h2>




<p>
The <font class="file">ChrisPE</font> project scripts can currently be divided into seven distinct sections -
<ul>
<li><a class="internal" href="#core">Core</a></li>
<li><a class="internal" href="#shell">Shell</a></li>
<li><a class="internal" href="#settings">Settings</a></li>
<li><a class="internal" href="#applications">Applications</a></li>
<li><a class="internal" href="#finalise">Finalise</a></li>
<li><a class="internal" href="#mediacreation">MediaCreation</a></li>
<li><a class="internal" href="#postconfig">PostConfig</a></li>
</ul>
</p>





<p>
A number of configurable options are contained in the main project file. The screenshots below display these options (clicking on the <i>HELP</i> button from within the project displays information about what the individual options do) - 
<br />
<a href="img/main_1_1.jpg"><IMG SRC="img/main_1_1.jpg" float=left width=70% margin-right=1% margin-bottom=0.5em border=1></a>


<br />
<br />
<a href="img/main_2_1.jpg"><IMG SRC="img/main_2_1.jpg" float=left width=70% margin-right=1% margin-bottom=0.5em border=1></a>
<br />
</p>





<a name="core"></a><br>
<h2><u>Core Scripts</u></h2>


<p>
Please note that only two of the scripts in this section are actually visible to the end user in the PEBakery User Interface - the remainder are hidden from view in an effort to declutter the interface.


<ul class="break3em"><li>
<b>Core Files</b> - This script cannot be disabled. Most of the work is carried out in this script, including error checks, file checks, verifying source language/build/processor architecture, and copying and extracting the required files from the selected source. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Core</font> &gt; <font class="file">A_core.script</font>
</li></ul>



<ul class="break3em">
<li><b>Browse for Folder</b> - used to add Browse for Folder dialog support. This script is hidden and is executed by other scripts to ensure that Browse for Folder support is added as required for individual applications. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Core</font> &gt; <font class="file">Browse.For.Folder.script</font></li>
</ul>



<ul class="break3em">
<li><b>Common Commands</b> - this script is hidden and is executed by other scripts as required. Supported commands include directory delete (following an error) and creating startmenu shortcuts. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Core</font> &gt; <font class="file">common.script</font></li>
</ul>



<ul class="break3em">
<li><b>WoW64</b> - Add WoW64 support. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Core</font> &gt; <font class="file">G_WoW64.script</font>.</li>
</ul>



<ul class="break3em">
<li><b>SysWOW64</b> - this script is hidden. It contains registry settings required for WoW64 support. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Core</font> &gt; <font class="file">syswow64.script</font></li>
</ul>




<ul class="break3em">
<li><b>Verification Checks</b> - this script is hidden and is executed by other program scripts for a range of checks including identification of source files. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Core</font> &gt; <font class="file">verify.script</font></li>
</ul>











<a name="shell"></a><br>
<h2><u>Shell Scripts</u></h2>


<p>
<ul class="break3em">
<li><b>Shell</b> - select a shell. Current options are <font class="file">WinXShell</font>, <font class="file">bblean</font>, <font class="file">CMD</font> and <font class="file">LaunchBar</font>. The shell script is context sensitive and different options will be visible depending on the selected shell. Click on the <font class="file">HELP</font> buttons for information about the available options. 


<br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Shell</font> &gt; <font class="file">B_shell.script</font></li>
	<br />
	<ul>
	<b>WinXShell</b> shell options -
	<br />
	<a href="img/shell_1.jpg"><IMG SRC="img/shell_1.jpg" float=left width=70% margin-right=1% margin-bottom=0.5em border=1></a>
	</ul>

	<ul>
	<b>LaunchBar</b> shell options -
	<br />
	<a href="img/shell_2.jpg"><IMG SRC="img/shell_2.jpg" float=left width=70% margin-right=1% margin-bottom=0.5em border=1></a>
	</ul>
</ul>







<ul class="break3em">
<li><b>Default Filemanager</b> - set the default FileExplorer. Either <font class="file">7-zip</font>, <font class="file">Explorer++</font>, <font class="file">Q-Dir</font> or <font class="file">7-zip</font> can be selected.<br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Shell</font> &gt; <font class="file">B_shell.script</font></li>
	<br />
	<ul>
	<a href="img/filemanager_1.jpg"><IMG SRC="img/filemanager_1.jpg" float=left width=70% margin-right=1% margin-bottom=0.5em border=1></a>
	</ul>
</ul>
</p>








<a name="settings"></a><br>
<h2><u>Settings Scripts</u></h2>


<p>
<ul class="break3em">
<li><b>Recommended</b> - <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Settings</font> &gt; <font class="file">Recommended.script</font></li>
	<ul>
	<li class="break1em"><b>BootSect</b> - tool used to add <font class="file">NTLDR</font> or <font class="file">BOOTMGR</font> code to a Volume Boot Record. This script adds a batch file to the build as the required program is already included. The batch can be executed by right-clicking on a drive in Explorer. 
	</li>

	<li class="break1em"><b>CMD Here</b> - Start a command prompt from the right-click context menu. 
	</li>

	<li class="break1em"><b>Keyboard Layout</b> - change the keyboard layout in <font class="file">WinPE</font> whilst it's running. Uses <font class="file">wpeutil</font> tool that is already included in the build.
	</li>

	<li class="break1em"><b>Network</b> - This will add a batch file + a menu entry to run it. The batch file runs the command <i>"wpeinit InitializeNetwork"</i> - this will Initialize network components and drivers, and set the computer name to a randomly-chosen value. This command is usually executed in <font class="file">startnet.cmd</font> on a standard <font class="file">WinPE</font>. I found that running this command causes an unnecessary delay when <font class="file">WinPE</font> boots and therefore added it as a menu option so that it can be started <i><u>if required</u></i>.
	</li>

	<li class="break1em"><b>ScreenRes</b> - This will add a menu option for changing the screen resolution. No external programs are used, however a number of xml files are added - this option simply starts a batch file that will run the <font class="file">wpeinit</font> command to change the screen resolution to a value set in the included xml files. A number of screen resolutions are available in the batch file. 
	</li>
	</ul>
</ul>



<ul class="break3em">
<li><b>Tweaks</b> - includes a range of tweaks. Click on the <font class="file">?</font> buttons for information about the available options. 
<br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Settings</font> &gt; <font class="file">Tweaks.script</font></li>
	<br />
	<a href="img/tweaks.png"><IMG SRC="img/tweaks.png" float=left width=70% margin-right=1% margin-bottom=0.5em border=1></a>
</ul>



<ul class="break3em">
<li><b>Wallpaper</b> - select a custom wallpaper. A project wallpaper can be used. Not working if <font class="file">LaunchBar</font> or <font class="file">CMD</font> are selected as shell. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Settings</font> &gt; <font class="file">wallpaper.script</font></li>
</ul>
</p>

















<a name="applications"></a><br>
<h2><u>Applications Scripts</u></h2>

<p>
The following lists all of the program/application scripts that are included in the <font class="file">ChrisPE</font> project download.
</p>



<p>
<ul class="break3em">
<li>
<b>LaunchBar</b> - a program launcher created by <font class="file">Peter Lerup</font>. "<i>...LaunchBar is a small Windows freeware program that mimics the behavior of the dockable QuickLaunch toolbar that was available in all Windows versions before Windows 7...</i>". Please refer to the <font class="file">LaunchBar</font> website (see <a class="external" target="_blank" href="http://www.lerup.com/LaunchBar/">here</a>) for more information. 
<br /><br />
If <font class="file">LaunchBar</font> is enabled, an option to add shortcuts to the LaunchBar menu can be selected in application scripts. Screenshot of <font class="file">LaunchBar</font> running -
</li>
<IMG SRC="img/launchbar.jpg" WIDTH=500 BORDER=2>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>
</ul>






<ul>
<li>
<b>Add Custom Folders\Files</b> - select a directory and it's contents will be added to the build.
	<ul>
	<li>Included in download - N/A</li>
	<li>Processor Architecture - N/A</li>
	</ul>

</li>
</ul>



<ul>
<li>
<b>7-Zip</b> (version 16.04) - File archiver. Used to extract contents from <i>.zip</i>/<i>.7z</i>/<i>.iso</i>/<i>.wim</i> files and numerous other file types. Can also create <i>.zip</i> and <i>.7z</i> files. Right click a file in explorer to access menu options for extracting from or creating files. <a class="external" target="_blank" href="http://www.7-zip.org/">7-zip website</a>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>

</li>
</ul>




<ul>
<li>
<b>Disk Management</b> - Disk management console (diskmgmt.msc). Not working in <font class="file">WinPE</font> 2.* (Vista sources). This will add an option to install diskmgmt.msc on demand. Credit to IcemanND on the msfn forum - see <a class="external" target="_blank" href="http://www.msfn.org/board/topic/153842-disk-partition-gui-in-winpe/?p=979055">here</a>.
	<ul>
	<li>Included in download - <b>N/A</b></li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>
</li>
</ul>





<ul>
<li>
<b>DMDE</b> (Version 3.4.2) - "...is a powerful software for data searching, editing, and recovery on disks. It may recover directory structure and files in some complicated cases through the use of special algorithms when other software can't help....DMDE has a number of freeware features such as disk editor, simple partition manager (e.g. allows undelete a partition), a tool to create disk images and clones, RAID constructor, file recovery from the current panel....DMDE supports FAT12/16, FAT32, NTFS, Ext2/3/4..." The Free Edition is included in the download - please refer to the  License Agreement - <a class="internal" href="eula_en.txt">here</a>. <a class="external" target="_blank" href="http://dmde.com/">DMDE website</a>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - <b>x86 only</b></li>
	</ul>
</li>
</ul>


<ul>
<li>
<b>Explorer++</b> (version 1.3.5) - file manager with multiple pane and tab support. <a class="external" target="_blank" href="https://explorerplusplus.com/">Explorer++ website</a>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>
</li>
</ul>





<ul>
<li>
<b>ImDisk</b> (version 2.0.9) - ImDisk is a virtual disk driver for Windows. It can create virtual hard disk, floppy or CD/DVD drives using image files or system memory. Right click on supported image types (e.g. <b>.iso</b> files) to mount them as virtual drives. Can also be used to create disc images of real drives. <a class="external" target="_blank" href="http://www.ltr-data.se/opencode.html/#ImDisk">ImDisk website</a>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>
</li>
</ul>



<ul>
<li>
<b>JustManager</b> (Version 0.1 Alpha 54) - file manager with multiple pane and tab support. <a class="external" target="_blank" href="http://justmanager.ru/">JustManager website</a>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>
</li>
</ul>


<ul>
<li>
<b>Q-Dir</b> - Quad explorer file manager with multiple pane and tab support. <a class="external" target="_blank" href="https://www.softwareok.com/?seite=Freeware/Q-Dir">Q-Dir website</a>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>
</li>
</ul>




<ul>
<li>
<b>Sumatra</b> (Version 3.1.2) - <b>.PDF</b> file reader. <a class="external" target="_blank" href="https://www.sumatrapdfreader.org/">SumatraPDF website</a>
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - x86 and x64</li>
	</ul>
</li>
</ul>






<ul>
<li>
<b>TinyHexer</b> (version 1.7) - Tiny hexer is a hex editor for binary files. It will also allow access and editing of disk sectors. 
	<ul>
	<li>Included in download - YES</li>
	<li>Processor Architecture - <b>x86 only</b></li>
	</ul>
</li>
</ul>










<a name="finalise"></a><br>
<h2><u>Finalise</u></h2>



<p>
Only one script is included in this section -


<ul class="break3em"><li>
<b>Shell - Finalise</b> - This script cannot be disabled. Menu entries are configured via this script , <font class="file">winpeshl.ini</font> is created, and files are injected to <font class="file">boot.wim</font>. <br />Path - <font class="file">Projects</font> &gt; <font class="file">ChrisPE</font> &gt; <font class="file">Finalise</font> &gt; <font class="file">xxxShell.script</font>
</li></ul>
</p>










<a name="mediacreation"></a><br>
<h2><u>MediaCreation</u></h2>

<p>
The script in this section can either be selected during the build process, or can be executed independently afterwards - as long as the build completed successfully. Files in the <font color="red">%BaseDir%</font><font color="blue">\ChrisPE.Files\ISO.ROOT\</font> directory (where <i><font color="red">%BaseDir%</font></i> refers to the directory from which <font class="file">PEBakeryLauncher.exe</font> is running) are added to the .iso file.
</p>


<p>
<ul>
<li>
<b>Create ISO</b> - this script includes a number of options, the default settings will create a RAM bootable ISO file using MKISOFS - for use on BIOS and UEFI based systems. It's also possible to create a Flat Boot <font class="file">WinPE</font> (<font class="file">WinPE</font> 2.x/3.x only) or even a multiboot ISO file with options for RAM Boot and Flat Boot - bootable on UEFI and BIOS based systems. 
</li>
</ul>



<p>
To execute the Create ISO script following a build, simply select the script in the directory tree and click on the <font class="file">Run Script</font> button to the right of the title bar -
<br />
<a href="img/project1.png"><IMG SRC="img/project1.png" float=left width=90% margin-right=1% margin-bottom=0.5em border=1></a>
</p>









<a name="postconfig"></a><br>
<h2><u>PostConfig</u></h2>

<p>
The script in this section cannot be executed during the build process and is designed for post processing.
</p>



<ul>
<li>
<b>Advanced Options</b> - Can be used to mount/unmount the registry hives created when the <font class="file">ChrisPE</font> project has finished the build process. This script can also be used to inject (add) additional files to <font class="file">boot.wim</font> and carry out some additional tasks. 
</li>
</ul>






<p class="breaktop"><font class="file">Document date - 6<sup>th</sup> March 2018</font></p></font></body></html>
